<!DOCTYPE html>
<!-- /* 
Bernard Williams
UCF Bootcamp APR2017 Week 4
RPG Starwars Game
*/ -->
<html>

<head>
    <meta charset=utf-8>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Script-Type" content="text/javascript">
    <title>Bernard L. Williams - RPG Starwars</title>
    <link href="assets/css/reset.css" rel="stylesheet">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"
        crossorigin="anonymous">
    <link rel="stylesheet" href="https://bootswatch.com/cyborg/bootstrap.min.css">
    <link href="assets/css/style.css" rel="stylesheet">
</head>

<body onload="">
    <nav class="navbar navbar-inverse">
        <div class="container-fluid">
            <div class="navbar-header">
                <a class="navbar-brand" href="#">Bernard L. Williams</a>
            </div>
            <ul class="nav navbar-nav">

                <li><a href='index.html' class="active">Lets Play Star Wars RPG!!</a></li>
                <li><a href="instructions.html">Instructions</a></li>
            </ul>
        </div>
    </nav>

    <div class="container mainArea">
        <!-- Header Row -->

        <!-- Main Content Area Row -->
        <div class="row">
            <div class="col-md-4">
                <div class="panel panel-default panel-transparent">
                    <div class="panel-heading">
                        Choose your character
                    </div>
                    <!-- This shows the panel body -->
                    <div class="panel-body" id="characters">

                    </div>

                </div>
            </div>
            <div class="col-md-4">
                <div class="panel panel-default panel-transparent">
                    <div class="panel-heading">
                        Enemies
                    </div>
                    <div class="panel-body" id="enemies">
                    </div>

                </div>
            </div>
            <div class="col-md-4">
                <div class="panel panel-default panel-transparent">
                    <div class="panel-heading">
                        Defender
                    </div>
                    <div class="panel-body" id="defender">

                    </div>

                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-6">
                <div class="panel panel-default panel-transparent">
                    <div class="panel-heading">
                        Fight Section
                    </div>
                    <div class="panel-body" id="fightSection">

                    </div>
                    <div class="panel-footer">
                        <button type="button" id="attack" class="btn btn-primary">Attack!!</button>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="panel panel-default panel-transparent">
                    <div class="panel-heading">
                        Control Panel
                    </div>
                    <div class="panel-body" id="controlPanel">

                    </div>
                    <div class="panel-footer"> <span id="overallAvg"></span><a href="index.html"><button type="button" class="btn btn-primary">Restart</button></a></div>
                </div>
            </div>
        </div>

    </div>

    </div>

    <!-- Latest compiled and minified JavaScript -->
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.2.0.min.js"></script>
    <script src="assets/javascript/games.js"></script>
    <script src="assets/javascript/config.js"></script>
    <script>
        //global variables
        var currentPlayerID = '';
        var currentDefenderID = '';
        var enemies = []; //array of enemy players
        var currentPlayer = {};
        var currentDefender = {};

        //Enumeration to represent game state
        var gameState = {
            newGame: true,
            defenderSelected: false,
            playerSelected: false,
            playerDefeated: false,
            defenderDefeated: false
        }

        $(document).ready(function () {

            initializePlayers();
            
            //Once the document is loaded check the config file and add a media object for each player in the config file
            for (var index = 0; index < characters.length; index++) {
                var player = characters[index];
                console.log('------------------------------------');
                console.log(player);

                //set the hit points for the players

                //Create a new media object for each character in the config file
                var newCharacterElement = $("<div>");
                newCharacterElement.addClass('media player');
                newCharacterElement.attr('id', characters[index].id)

                var newMediaLeft = $("<div>");
                newMediaLeft.addClass('media-left');

                var newMediaImage = $("<img>");
                newMediaImage.addClass('media-object media-image');
                newMediaImage.attr('src', characters[index].imgURL)


                var newMediaBody = $("<div>");
                newMediaBody.addClass('media-body');

                //Generate heading
                var newMediaHeading = $("<h4>");
                newMediaHeading.addClass('media-heading');
                newMediaHeading.text(characters[index].name);
                var hpLabel = $("<span id='hpbadge'>");
                hpLabel.addClass("badge healthPoints badge-success");
                hpLabel.text(characters[index].healthPoints)
                newMediaHeading.append(hpLabel);
                var apLabel = $("<span id='apbadge'>");
                apLabel.addClass("badge healthPoints badge-warning");
                apLabel.text(characters[index].attackPower)
                newMediaHeading.append(apLabel);
                var capLabel = $("<span id='cpbadge'>");
                capLabel.addClass("badge healthPoints badge-danger");
                capLabel.text(characters[index].counterAttackPower)
                newMediaHeading.append(capLabel);


                var newMediaText = $("<p>");
                newMediaText.text(characters[index].desc);

                newMediaLeft.append(newMediaImage);
                newMediaBody.append(newMediaHeading);
                newMediaBody.append(newMediaText);
                newCharacterElement.append(newMediaLeft);
                newCharacterElement.append(newMediaBody);

                $("#characters").append(newCharacterElement);

                //Put a border around the character panel
                $('#characters').addClass('panelBorder');
                $('#fightSection').text('... Please select your character to start...');

            }

            //When the user clicks a player move that player to the fight section and move the remaining players to the enemies secition
            $(".media").click(function () {

                if (gameState.newGame) {
                    gameState.newGame = false;
                    currentPlayerID = $(this).attr('id');
                    gameState.playerSelected = true;

                    //Put a border around the enemies panel
                    $('#enemies').addClass('panelBorder');
                    $('#characters').removeClass('panelBorder');
                    $('#fightSection').text('... Please select who you want to fight first...');

                    //Load the global array that holds the enemies
                    characters.forEach(getEnemies); //function in game.js

                    for (var i = 0; i < enemies.length; i++) {
                        $("#" + enemies[i].id).appendTo("#enemies");
                    }
                } else if (currentPlayerID != $(this).attr('id')) { //check to see which player has been selected to be
                    if (!gameState.defenderSelected) {              // in the defense     
                        gameState.defenderSelected = true;
                        currentDefenderID = $(this).attr('id');     //Set the global variable for the selected defender
                        $("#" + $(this).attr('id')).appendTo("#defender");

                        //Put a border around the fightSection panel
                        $('#fightSection').addClass('panelBorder');
                        $('#enemies').removeClass('panelBorder');
                        $('#fightSection').text('... Press the attack button to start beating ass...');
                    }

                }

            });

        });
    </script>



</body>

</html>